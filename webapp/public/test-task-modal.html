<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–¢–µ—Å—Ç –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∑–∞–¥–∞—á–∏</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="task-detail-modal.css">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        body {
            background: #1a1a2e;
            padding: 20px;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
        }
        .test-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px;
        }
        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        .debug-output {
            background: #2a2a2a;
            color: #fff;
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .task-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 16px;
            border-radius: 12px;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
        }
        .task-card:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-2px);
        }
        .task-title {
            font-weight: 600;
            font-size: 16px;
            margin-bottom: 8px;
        }
        .task-meta {
            color: rgba(255, 255, 255, 0.6);
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1 style="color: white;">–¢–µ—Å—Ç –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –¥–µ—Ç–∞–ª–µ–π –∑–∞–¥–∞—á–∏</h1>

        <div>
            <button class="test-button" onclick="testWithMockData()">–¢–µ—Å—Ç —Å –º–æ–∫–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏</button>
            <button class="test-button" onclick="checkFunctions()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏</button>
            <button class="test-button" onclick="clearDebug()">–û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏</button>
        </div>

        <h3 style="color: white; margin-top: 30px;">–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –∑–∞–¥–∞—á—É:</h3>
        <div id="taskCards">
            <div class="task-card" onclick="showTaskDetails('task-1')">
                <div class="task-title">üìã –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –æ—Ç—á–µ—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º</div>
                <div class="task-meta">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å: –ò–≤–∞–Ω ‚Ä¢ –î–µ–¥–ª–∞–π–Ω: 5 –¥–µ–∫–∞–±—Ä—è</div>
            </div>
            <div class="task-card" onclick="showTaskDetails('task-2')">
                <div class="task-title">üîß –ò—Å–ø—Ä–∞–≤–∏—Ç—å –±–∞–≥ –≤ —Å–∏—Å—Ç–µ–º–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏</div>
                <div class="task-meta">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å: –ú–∞—Ä–∏—è ‚Ä¢ –î–µ–¥–ª–∞–π–Ω: 3 –¥–µ–∫–∞–±—Ä—è</div>
            </div>
            <div class="task-card" onclick="showTaskDetails('task-3')">
                <div class="task-title">üì± –†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –º–æ–±–∏–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é</div>
                <div class="task-meta">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å: –ê–ª–µ–∫—Å–µ–π ‚Ä¢ –î–µ–¥–ª–∞–π–Ω: 10 –¥–µ–∫–∞–±—Ä—è</div>
            </div>
        </div>

        <div id="debugOutput" class="debug-output">–ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é...</div>
    </div>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ -->
    <script>
        // –ú–æ–∫ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        window.formatDate = function(dateString) {
            if (!dateString) return '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
            const date = new Date(dateString);
            const options = { day: 'numeric', month: 'long', year: 'numeric' };
            return date.toLocaleDateString('ru-RU', options);
        };

        window.getPriorityText = function(priority) {
            const priorities = {
                'high': 'üî¥ –í—ã—Å–æ–∫–∏–π',
                'medium': 'üü° –°—Ä–µ–¥–Ω–∏–π',
                'low': 'üü¢ –ù–∏–∑–∫–∏–π'
            };
            return priorities[priority] || 'üü° –°—Ä–µ–¥–Ω–∏–π';
        };

        window.getStatusText = function(status) {
            const statuses = {
                'new': 'üîµ –ù–æ–≤–∞—è',
                'in-progress': 'üü° –í —Ä–∞–±–æ—Ç–µ',
                'completed': 'üü¢ –í—ã–ø–æ–ª–Ω–µ–Ω–∞'
            };
            return statuses[status] || 'üîµ –ù–æ–≤–∞—è';
        };

        window.showNotification = function(message, type) {
            log(`üì¢ Notification [${type}]: ${message}`);
        };

        window.loadTasks = function() {
            log('üìã –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞—á (—ç–º—É–ª—è—Ü–∏—è)');
        };

        window.showEditTaskModal = function(task) {
            log('‚úèÔ∏è –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –∑–∞–¥–∞—á–∏: ' + task.id);
        };

        window.currentUser = {
            id: 'user-1',
            name: '–ò–≤–∞–Ω',
            isManager: true
        };

        // –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
        window.currentTasks = [
            {
                id: 'task-1',
                title: '–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –æ—Ç—á–µ—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º',
                description: '–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–±—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∫–≤–∞—Ä—Ç–∞–ª –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é –¥–ª—è —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞',
                employee: '–ò–≤–∞–Ω',
                employeeName: '–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤',
                creator: '–ú–∞—Ä–∏—è',
                creatorName: '–ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞',
                creatorId: 'user-2',
                deadline: '2025-12-05',
                createdAt: '2025-12-01',
                priority: 'high',
                status: 'new'
            },
            {
                id: 'task-2',
                title: '–ò—Å–ø—Ä–∞–≤–∏—Ç—å –±–∞–≥ –≤ —Å–∏—Å—Ç–µ–º–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏',
                description: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–æ–æ–±—â–∞—é—Ç –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –≤—Ö–æ–¥–æ–º —á–µ—Ä–µ–∑ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏. –ù—É–∂–Ω–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å.',
                employee: '–ú–∞—Ä–∏—è',
                employeeName: '–ú–∞—Ä–∏—è –°–µ—Ä–≥–µ–µ–≤–∞',
                creator: '–ê–ª–µ–∫—Å–µ–π',
                creatorName: '–ê–ª–µ–∫—Å–µ–π –°–º–∏—Ä–Ω–æ–≤',
                creatorId: 'user-3',
                deadline: '2025-12-03',
                createdAt: '2025-11-28',
                priority: 'medium',
                status: 'in-progress'
            },
            {
                id: 'task-3',
                title: '–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –º–æ–±–∏–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é',
                description: '–°–æ–∑–¥–∞—Ç—å –∞–¥–∞–ø—Ç–∏–≤–Ω—É—é –≤–µ—Ä—Å–∏—é —Å–∞–π—Ç–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞',
                employee: '–ê–ª–µ–∫—Å–µ–π',
                employeeName: '–ê–ª–µ–∫—Å–µ–π –ö–æ–∑–ª–æ–≤',
                creator: '–ò–≤–∞–Ω',
                creatorName: '–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤',
                creatorId: 'user-1',
                deadline: '2025-12-10',
                createdAt: '2025-12-01',
                priority: 'low',
                status: 'new'
            }
        ];

        const debugDiv = document.getElementById('debugOutput');

        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            debugDiv.innerHTML += `\n[${timestamp}] ${message}`;
            console.log(message);
            debugDiv.scrollTop = debugDiv.scrollHeight;
        }

        function clearDebug() {
            debugDiv.innerHTML = '–õ–æ–≥–∏ –æ—á–∏—â–µ–Ω—ã...';
        }

        function testWithMockData() {
            log('\n=== –¢–µ—Å—Ç —Å –º–æ–∫–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ ===');
            if (typeof window.showTaskDetails === 'function') {
                log('‚úÖ –§—É–Ω–∫—Ü–∏—è showTaskDetails –Ω–∞–π–¥–µ–Ω–∞');
                try {
                    window.showTaskDetails('task-1');
                    log('‚úÖ –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç–æ');
                } catch (e) {
                    log('‚ùå –û—à–∏–±–∫–∞: ' + e.message);
                }
            } else {
                log('‚ùå –§—É–Ω–∫—Ü–∏—è showTaskDetails –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!');
            }
        }

        function checkFunctions() {
            log('\n=== –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π ===');
            const functions = [
                'showTaskDetails',
                'closeTaskDetailModal',
                'startTask',
                'completeTask',
                'editTaskFromDetail',
                'deleteTaskFromDetail'
            ];

            functions.forEach(fn => {
                if (typeof window[fn] === 'function') {
                    log('‚úÖ ' + fn + ' - –¥–æ—Å—Ç—É–ø–Ω–∞');
                } else {
                    log('‚ùå ' + fn + ' - –ù–ï –ù–ê–ô–î–ï–ù–ê');
                }
            });

            log('\n=== –ü—Ä–æ–≤–µ—Ä–∫–∞ DOM ===');
            const modal = document.getElementById('taskDetailModal');
            log('taskDetailModal: ' + (modal ? '‚úÖ –ù–∞–π–¥–µ–Ω' : '‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω'));

            log('\n=== –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö ===');
            log('currentTasks: ' + (window.currentTasks ? '‚úÖ ' + window.currentTasks.length + ' –∑–∞–¥–∞—á' : '‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω'));
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            log('üöÄ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞, –Ω–∞—á–∏–Ω–∞–µ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...');
            setTimeout(() => {
                checkFunctions();
            }, 500);
        });
    </script>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
    <script src="task-detail-modal.js"></script>
</body>
</html>